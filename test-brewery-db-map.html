<!DOCTYPE HTML>
<html>

<head>
    <title>BreweryDB Test</title>
    <meta charset="utf-8" />

</head>

<body>

    <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/css/materialize.min.css">
<script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/js/materialize.min.js"></script>

    <div class="input-field col s12">
      <select name="state" id="state">
                        <option value="AL">Alabama</option>
                        <option value="AK">Alaska</option>
                        <option value="AZ">Arizona</option>
                        <option value="AR">Arkansas</option>
                        <option value="CA">California</option>
                        <option value="CO">Colorado</option>
                        <option value="CT">Connecticut</option>
                        <option value="DE">Delaware</option>
                        <option value="DC">D.C.</option>
                        <option value="FL">Florida</option>
                        <option value="GA">Georgia</option>
                        <option value="HI">Hawaii</option>
                        <option value="ID">Idaho</option>
                        <option value="IL">Illinois</option>
                        <option value="IN">Indiana</option>
                        <option value="IA">Iowa</option>
                        <option value="KS">Kansas</option>
                        <option value="KY">Kentucky</option>
                        <option value="LA">Louisiana</option>
                        <option value="ME">Maine</option>
                        <option value="MD">Maryland</option>
                        <option value="MA">Massachusetts</option>
                        <option value="MI">Michigan</option>
                        <option value="MN">Minnesota</option>
                        <option value="MS">Mississippi</option>
                        <option value="MO">Missouri</option>
                        <option value="MT">Montana</option>
                        <option value="NE">Nebraska</option>
                        <option value="NV">Nevada</option>
                        <option value="NH">New Hampshire</option>
                        <option value="NJ">New Jersey</option>
                        <option value="NM">New Mexico</option>
                        <option value="NY">New York</option>
                        <option value="NC">North Carolina</option>
                        <option value="ND">North Dakota</option>
                        <option value="OH">Ohio</option>
                        <option value="OK">Oklahoma</option>
                        <option value="OR">Oregon</option>
                        <option value="PA">Pennsylvania</option>
                        <option value="RI">Rhode Island</option>
                        <option value="SC">South Carolina</option>
                        <option value="SD">South Dakota</option>
                        <option value="TN">Tennessee</option>
                        <option value="TX">Texas</option>
                        <option value="UT">Utah</option>
                        <option value="VT">Vermont</option>
                        <option value="VA">Virginia</option>
                        <option value="WA">Washington</option>
                        <option value="WV">West Virginia</option>
                        <option value="WI">Wisconsin</option>
                        <option value="WY">Wyoming</option>
                      </select>
  <label>Materialize Select</label>
  </div>

  <br>

    <button id='submit'>Submit</button>

    <style>
        #map {
            height: 400px;
            width: 100%;
        }
    </style>

    </head>

    <body>
        <h3>My Google Maps Demo</h3>
        <div id="map"></div>
        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQJz1ltJYXEpNY4PAQyZ9pO7fK6cvfFp4&callback=initMap">
        </script>
        <script type="text/javascript">
            var map;
            var states = ["Virginia", "Maryland", "District of Columbia"];

            $('button').on('click', function() {
                for (var i = 0; i < states.length; i++) {

                    var queryURL = "https://api.brewerydb.com/v2/locations?key=70a61c6760fc3a51e28ad788197d9359&region=" + states[i];

                    $.ajax({
                            url: queryURL,
                            beforeSend: function(request) {
                                request.setRequestHeader("Authorization", "Negotiate");
                            },
                            async: true,
                            method: 'GET'
                        })
                        .done(function(response) {
                            var results = response.data;
                            var cleanData = cleanUp(results);
                            createMarkers(cleanData);
                        })
                }
            });

            function cleanUp(results) {
                var latsAndLongs = [];
                for (var i = 0; i < results.length; i++) {
                    var lat = results[i].latitude;
                    var long = results[i].longitude;
                    var name = results[i].brewery.name;
                    var latLong = {
                        name: name,
                        lat: lat,
                        lng: long
                    };
                    latsAndLongs.push(latLong);
                }
                return latsAndLongs;
            }

            function initMap() {
                var uluru = {
                    lat: 38.9072,
                    lng: -77.0369
                };
                map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 12,
                    center: uluru,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                });


            };



            function createMarkers(markerObjs) {

                var marker, i;

                for (var i = 0; i < markerObjs.length; i++) {
                    marker = new google.maps.Marker({
                        position: new google.maps.LatLng(markerObjs[i].lat, markerObjs[i].lng),
                        map: map
                    });
                    google.maps.event.addListener(marker, 'click', (function(marker, i) {
                        return function() {
                            var infowindow = new google.maps.InfoWindow();
                            infowindow.setContent(markerObjs[i].name);
                            infowindow.open(map, marker);
                        }
                    })(marker, i));
                }
            }
        </script>


    </body>

</html>
</body>

</html>
